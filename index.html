<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIAMOND OMNI v6.0 | ARCHITECT EDITION</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <canvas id="diamond-bg"></canvas>

    <div id="main-shell" class="ani-fade-in">
        <header class="app-header">
            <div class="brand">
                <div class="diamond-logo"></div>
                <h1>DIAMOND <span>OMNI</span></h1>
            </div>
            <div id="system-clock">00:00:00</div>
        </header>

        <nav class="master-tabs">
            <button class="t-btn active" onclick="ui.switchTab('dash')">BẢNG ĐIỀU KHIỂN</button>
            <button class="t-btn" onclick="ui.switchTab('rank')">BẢNG XẾP HẠNG</button>
            <button class="t-btn" onclick="ui.switchTab('logs')">LỊCH SỬ CHI TIẾT</button>
        </nav>

        <main class="viewport">
            <section id="tab-dash" class="tab-content active">
                <div class="config-grid">
                    <div class="field full"><label>Tiêu đề bài thi</label><input type="text" id="in-title" placeholder="Nhập tên kỳ thi..."></div>
                    <div class="field"><label>Tài liệu nguồn</label><input type="file" id="in-file" accept=".pdf,.docx,.txt"></div>
                    <div class="field"><label>Số lượng câu</label><input type="number" id="in-count" value="10"></div>
                    <div class="field"><label>Thời gian (phút)</label><input type="number" id="in-time" value="15"></div>
                    <div class="field"><label>Chế độ AI</label>
                        <select id="in-mode">
                            <option value="Logical">Logic chặt chẽ</option>
                            <option value="Creative">Sáng tạo & Mở rộng</option>
                        </select>
                    </div>
                    <div class="field full"><label>Ghi chú cho AI</label><textarea id="in-prompt" placeholder="Ví dụ: Tập trung vào chương 1..."></textarea></div>
                </div>
                <button class="btn-glow" onclick="app.generateFlow()">KÍCH HOẠT HỆ THỐNG AI</button>
            </section>

            <section id="tab-rank" class="tab-content">
                <div class="rank-container" id="rank-render"></div>
            </section>

            <section id="tab-logs" class="tab-content">
                <div class="history-list" id="logs-render"></div>
            </section>
        </main>
    </div>

    <div id="layer-load" class="overlay hidden">
        <div class="pop-card loader-card">
            <div class="gem-spinner"></div>
            <h2 id="load-text">Đang phân tích dữ liệu...</h2>
            <div class="prog-bar"><div id="prog-fill"></div></div>
        </div>
    </div>

    <div id="layer-pre" class="overlay hidden">
        <div class="pop-card wide">
            <h3>CẤU HÌNH TRƯỚC KHI THI</h3>
            <div class="setup-btns">
                <button onclick="app.shuffleQ()">XÁO TRỘN CÂU HỎI</button>
                <button onclick="app.shuffleA()">XÁO TRỘN ĐÁP ÁN</button>
                <button class="btn-edit" onclick="app.openEditor()">CHỈNH SỬA ĐỀ THI</button>
            </div>
            <div class="user-auth">
                <input type="text" id="user-name" placeholder="Nhập tên của Huy...">
                <button class="btn-start" onclick="app.startExam()">BẮT ĐẦU NGAY</button>
            </div>
        </div>
    </div>

    <div id="layer-work" class="overlay hidden">
        <div class="workspace-box">
            <header class="ws-head">
                <div class="ws-info">
                    <h2 id="ws-title">---</h2>
                    <div id="ws-clock">00:00</div>
                </div>
                <button class="btn-x" onclick="app.confirmExit()">✕</button>
            </header>
            <div id="ws-body" class="custom-scroll"></div>
            <footer class="ws-foot">
                <div class="ws-progress"><div id="ws-bar"></div></div>
                <button class="btn-glow" onclick="app.submitExam()">NỘP BÀI & PHÂN TÍCH</button>
            </footer>
        </div>
    </div>

    <div id="layer-result" class="overlay hidden">
        <div class="pop-card result-box wide ani-slide-up">
            <div id="certificate-area">
                <div class="cert-header">DIAMOND OMNI RESULT</div>
                <h1 id="res-score">0/0</h1>
                <p id="res-name">---</p>
                <div id="res-insight" class="insight-text">Đang AI phân tích lỗi sai...</div>
            </div>
            <div class="res-actions">
                <button onclick="app.exportCert()">TẢI CHỨNG CHỈ</button>
                <button class="btn-close" onclick="location.reload()">QUAY VỀ TRANG CHỦ</button>
            </div>
        </div>
    </div>

    <div id="layer-editor" class="overlay hidden">
        <div class="pop-card wide">
            <div class="ed-head"><h3>TRÌNH BIÊN TẬP</h3><button onclick="ui.hide('layer-editor')">✕</button></div>
            <div id="ed-body" class="custom-scroll"></div>
        </div>
    </div>

    <div id="layer-alert" class="overlay hidden">
        <div class="pop-card alert-box">
            <h4 id="alt-title">DIAMOND NOTICE</h4>
            <p id="alt-msg">---</p>
            <div class="alt-btns">
                <button id="alt-cancel" class="btn-sub hidden">HỦY</button>
                <button id="alt-ok" class="btn-glow">XÁC NHẬN</button>
            </div>
        </div>
    </div>

    <script src="ai-engine.js"></script>
    <script src="script.js"></script>
</body>
</html>
